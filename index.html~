<html>
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE11"/>
    <link rel="stylesheet" href="reveal.js/css/reveal.css">
    <link rel="stylesheet" href="reveal.js/css/theme/moon.css">
    <!--<link rel="stylesheet" href="css/theme/moon.css">-->
    <link rel="stylesheet" href="reveal.js/lib/css/zenburn.css" />
    <link rel="stylesheet" href="reveal.js/css/custom-gc.css" />
    <!--<link rel="stylesheet" href="css/additional.css">-->
</head>
<body>
  <div class="reveal">
    <div class="slides">
      
      <section>
	<h2>Unbiased simulation of scalar diffusion bridges with distant end-points</h2>
	<h4>(In search for a method of exact inference for discretely and sparsely observed diffusions)</h4>
	<p>
	  <small>Joint work by <a href="http://mmider.github.io">Marcin Mider</a>, <a href="https://warwick.ac.uk/fac/sci/statistics/staff/academic-research/jenkins/">Paul Jenkins</a>, <a href="https://warwick.ac.uk/fac/sci/statistics/staff/academic-research/pollock/">Murray Pollock</a>, <a href="https://warwick.ac.uk/fac/sci/statistics/staff/academic-research/roberts/">Gareth Roberts</a> and <a href="http://web.math.ku.dk/~michael/">Michael S&oslash;rensen</a></small>
	</p>
	<p><small>Univeristy of Warwick, Coventry, UK</small></p>
      </section>

      <section>
	<section>
	  <h2>Unbiased Computational Inference for SDEs</h2>
	</section>
	<section>
	  <h3>Imputation schemes</h3>
	  <div class="row no-margin-top">
	    <div class="col-30">
	      <p>Model of the form:</p>
	      <p>$dX_t=b_{\theta}(X_t)dt+\sigma_{\theta}(X_t)dW_t,$</p>
	      <p>$\qquad\qquad t\in[0,T]$</p>
	      <p>Available discrete time observations $\mathcal{D}:=\{X_{t_i}\}_{i=0}^{N}$</p>
	      <p>Interested in inference for $\theta$</p>
	    </div>
	    <div class="col-70 fig-container no-margin-top" data-file="d3-fig/gibbs.html"></div>
	  </div>
	</section>
      </section>

      <section>
	<section>
	  <h3>Imputation Problem</h3>
	  <img src="d3-fig/brownian_bridges.svg" alt="Brownian Bridges">
	  <h4>How to simulate diffusion bridges?</h4>
	</section>
	<section>
	  <h3>Literature review</h3>
	  <ul>
	    <li>Modified diffusion bridges (Durham and Gallant [2002], Golightly and Wilkinson [2008])</li>
	    <li>Delyon and Hu bridges (Delyon and Hu [2006])</li>
	    <li>Path Space Rejection Sampler (Beskos et al. [2005,2006])</li>
	    <li>Guided proposals (van der Meulen and Schauer [2017], Schauer et al. [2017])</li>
	    <li>Deterministic & Random component bridges (Whitaker et al. [2017])</li>
	    <li>Simple Diffusion Bridges (Bladt and S&oslash;rensen [2014])</li>
	    <li>Simulation of Langevin type SPDEs (Hairer et al. [2009])</li>
	  </ul>
	</section>
      </section>

      <section>
	<h3>Unbiasedness</h3>
	<img src="d3-fig/marginal_distro.png" alt="Marginal Distribution">
      </section>

      <section>
	<section>
	  <h3>Do such methods already exist?</h3>
	  <h4 class="fragment">Yes...</h4>
	  <h3 class="fragment" ><font color="#ffff99">Path Space Rejection Sampler</font></h3>
	  <h4 class="fragment">But...</h4>
	</section>
	<section>
	  <h3>PSRS overview</h3>
	  <p class="fragment">$$
	    \begin{equation}
	    \begin{split}
	    dX_t&=b_\theta(X_t)dt+\sigma_\theta(X_t)dW_t,\quad t\in[0,T]\\
	    &\qquad\qquad\bigg\downarrow Y_t:=\eta_\theta(X_t):=\int^{X_t}\sigma_{\theta}^{-1}(x)dx\\
	    &dY_t=\alpha_\theta(Y_t)+dW_t,\quad t\in[0,T]
	    \end{split}
	    \end{equation}
	    $$</p>
	  <p class="fragment">Let $\unicode{x2119}$ denote the Law of $Y$ and $\unicode{x1D54E}$ the standard Wiener Measure</p>
	  <p class="fragment">Propose paths $Y\sim\unicode{x1D54E}$, accept with probability $\propto\frac{d\unicode{x2119}}{d\unicode{x1D54E}}(Y)$.</p>
	</section>
	<section>
	  <h3>Output of PSRS</h3>
	  <div class="fig-container no-margin-top" data-file="d3-fig/psrs_overview.html"></div>
	</section>
      </section>

      <section>
	<section>
	  <h3>Why not just use PSRS?</h3>
	  <p class="fragment">Works for bridges and unconditioned diffusions</p>
	  <p class="fragment">Computational cost scales <mark><strong>exponentially</strong></mark> with $T$...</p>
	</section>
	<section>
	  <h3>Markov Property for unconditioned diffusions</h3>
	  <img src="d3-fig/psrs_forward.svg" alt="PSRS forward">
	</section>
	<section>
	  <h3>For bridges the technique does not work</h3>
	  <img src="d3-fig/psrs_condit.svg" alt="PSRS conditional">
	</section>
      </section>
      
      <section>
	<h3>Summary of the problem:</h3>
	<p class="fragment">Technique for sampling diffusion bridges</p>
	<p class="fragment">Needs to be unbiased</p>
	<p class="fragment">Needs to scale to bridges with distant end-points (large $T$)</p>
	<p class="fragment">Allow for dependent samples (MCMC for paths)</p>
      </section>

      <section>
	<h3>The idea</h3>
	<p class="fragment">Use an existing sampler - Simple Diffusion Bridges (Bladt and S&oslash;rensen [2014])</p>
	<p class="fragment">Substitute all steps introducing discretisation error with exact protocols</p>
	<p class="fragment">Output: MCMC sampler for diffusion bridges, with target invariant measure $\unicode{x2119}$ and no discretisation error!</p>
      </section>

      <section>
	<section>
	  <h3>Core result used for SDB</h3>
	  <div class="row no-margin-top">
	    <div>
	      <p><font color="#3DABB2">$dX^{(1)}_t=\alpha_{\theta}(X^{(1)}_t)dt+dW_t$, $X_0^{(1)}=x_0$</font> <font color="#F86942">$\quad dX^{(2)}_t=\alpha_{\theta}(X^{(2)}_t)dt+dW_t$, $X_0^{(2)}=x_T$</font></p>
	      <div class="fig-container no-margin-top" data-file="d3-fig/proposal_simple.html">
	      </div>
	</section>
	<section>
	  <h3>Connection with the target law</h3>
	  <img src="d3-fig/law_connection.svg" alt="Law connection">
	  <p><center><font color="#dd1c77">$dX_t=\alpha_{\theta}(X_t)dt+dW_t$, $t\in[0,T]$, $X_0=x_0$, $X_T=x_T$</font></center></p>
	  <p><center><font color="#c994c7">$\quad dX^{(3)}_t=\alpha_{\theta}(X^{(3)}_t)dt+dW_t$, $t\in[0,T]$, $X_{-T}^{(3)}=x_T$</font></center></p>
	</section>
	<section>
	  <h3>Define Markov Chain:</h3>
	  <p>Proposals $\sim\unicode{x211A}$</p>
	  <p>Accept with probability: $$\frac{\frac{d\unicode{x2119}}{d\unicode{x211A}}(X^{(prop)})}{\frac{d\unicode{x2119}}{d\unicode{x211A}}(X^{(old)})}\wedge 1=\frac{1/\pi(X^{(prop)})}{1/\pi(X^{(old)})}\wedge 1$$</p>
	  <p>Where $\pi(X)$ - probability that $X$ is intersected by an auxiliary diffusion</p>
	  <p>Pseudo-marginal (Andrieu and Roberts [2009])</p>
	  <p>$\unicode{x1D59F}^{(prop)}$ - unbiased estimate for $1/\pi(X^{(prop)})$</p>
	  <p>Sample $(X^{(prop)},\unicode{x1D59F}^{(prop)})$ and accept with probability $\unicode{x1D59F}^{(prop)}/\unicode{x1D59F}^{(old)}\wedge 1$</p>
	</section>
	<section>
	  <h3>How to sample $\unicode{x1D59F}^{(prop)}$?</h3>
	  <div class="row no-margin-top">
            <div class="fig-container no-margin-top" data-file="d3-fig/aux_sampler.html">
	    </div>
	  </div>
	  <div class="no-margin-top" style="position: absolute; top: 450px">
	    <p>Consider sequence of coin tosses: $U_i$, $i\in\unicode{x2115}_+$, $\unicode{x2119}(U_i=1)=\pi(X^{(prop)})$</p>
	    <p>$\unicode{x1D59F}^{(prop)}:=\inf\{i:U_i=1\}$</p>
	    <p>$\unicode{x1D59F}^{(prop)}\sim Geom(\pi(X^{(prop)}))$</p>
	    <p>So non-negative, unbiased estimate of $1/\pi(X^{(prop)})$</p>
	  </div>
	</section>
      </section>

      <section>
	<h3>Assumptions</h3>
	<ul>
	  <li>$\alpha_\theta$ is continuously differentiable</li>
	  <li>Function $\exp\big\{ A_\theta(u) -\frac{\|u-x\|^2}{2T} \big\}$ is integrable in $u$ for all $x\in \unicode{x211D}$, where $A_\theta(u):=\int^u \alpha_\theta(y)dy$</li>
	  <li>There exists $l^\theta_{low} > -\infty$ such that $l_{low}^\theta \leq \inf_{u\in\unicode{x211D}}\phi_\theta(u)$, where $\phi_\theta(u):=\frac{1}{2}\left(\alpha_\theta^2(u)+\alpha_\theta'(u)\right)$</li>
	  <li>There exists $l_{up}^\theta <\infty$ such that $l_{up}^\theta \geq \sup_{u\in\unicode{x211D}}\phi_\theta(u)-l_{low}^\theta$</li>
					    <li>Diffusion $Y$ is ergodic</li>
	</ul>
      </section>

      <section>
	<section>
	  <h3>Sampling with no error? (proposal)</h3>
	  <img src="d3-fig/basic_plot1.png" alt="Proposal sampler">
	</section>
	<section>
	  <h3>Sampling with no error? (proposal)</h3>
	  <img src="d3-fig/basic_plot2.png" alt="Proposal sampler">
	</section>
	<section>
	  <h3>Sampling with no error? (proposal)</h3>
	  <img src="d3-fig/basic_plot3.png" alt="Proposal sampler">
	</section>
	<section>
	  <h3>Probabilities for crossing</h3>
	  <p>$$\begin{equation}
	    \unicode{x2119}(\{\mbox{no crossing}\})=1-\exp\bigg\{-\frac{|d_0d_T|}{T}\bigg\}.
	    \end{equation}$$</p>
	  <p>Density for first passage time (Metwally and Atiya [2002]):</p>
	  <p>$$\begin{equation}
	    f_{\tau^{(D)}}(t)dt\propto t^{-3/2}(T-t)^{-1/2}\exp\bigg\{-\frac{d_T^2}{4(T-t)}-\frac{d_0^2}{4t}\bigg\}dt.
	    \end{equation}$$</p>
	  <p>This is the density of $\frac{T}{1/K+1}$, where $K\sim IGau\left(\left|\frac{d_0}{d_T}\right|, \frac{d_0^2}{2T}\right)$ and $IGau$ denotes the Inverse-Gaussian distribution</p>
	</section>
      </section>
      <section>
	<section>
	  <h3>Sampling with no error? (aux)</h3>
	  <img src="d3-fig/aux_plot1.png" alt="Proposal sampler">
	</section>
	<section>
	  <h3>Sampling with no error? (aux)</h3>
	  <img src="d3-fig/aux_plot2.png" alt="Proposal sampler">
	</section>
	<section>
	  <h3>Sampling with no error? (aux)</h3>
	  <img src="d3-fig/aux_plot3.png" alt="Proposal sampler">
	</section>
	<section>
	  <h3>Sampling crossing probability</h3>
	  <p>Coins with success probability (Metzler [2010]) e.g.</p>
	  <p>$\begin{equation}
	    \begin{split}
	    p=c(x_0,x_T,T)\sum_{n=1}^{\infty}\sin\bigg(\frac{n\pi\theta_T}{\alpha}\bigg)\sin\bigg(\frac{n\pi\theta_0}{\alpha}\bigg)I_{n\pi/\alpha}\bigg(\frac{r_Tr_0}{T}\bigg),
	    \end{split}
	    \end{equation}$</p>
	  <div class="col-46">
	    <p>(Devroye [1986]) Approximations $\hat{p}^{(n)}$, with errors $\epsilon_n$ $(|p-\hat{p}^{(n)}|<\epsilon_n)$ with $\epsilon_n\downarrow 0$ as $n\rightarrow\infty$.</p>
															  </div>
	  <img style="position: absolute; top: 300px; right: 10px;" class="col-50" src="d3-fig/algo.png" alt="Algorithm">
	</section>
      </section>

      <section>
	<section>
	  <h3>Numerical Example</h3>
	  <p>$dX_t=\frac{1}{2}\nabla\log\left[\left( 1+\frac{X_t^2}{v} \right)^{-\frac{v+1}{2}}\right]dt+dW_t,\quad t\in[0,T]$</p>
	  <p>Invariant distribution - t distribution</p>
	</section>
	<section>
	  <h3>Bias comparison</h3>
	<img src="d3-fig/bias_red.png" alt="Bias Reduction">
	</section>
	<section>
	  <h3>Typical paths</h3>
	  <img class="col-60" src="d3-fig/paths.png" alt="Paths">
	</section>
	<section>
	  <h3>Comparison of Computational Cost</h3>
	  <img src="d3-fig/timing.png" alt="Computational Cost">
	</section>
      </section>
      <section>
	<div style="position: absolute; width:80%; left: 100px; top: 250px; font-size: 80">
          Thank you for your attention!
	</div>
      </section>
      
</div> <!-- slides -->
</div> <!-- Reveal -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.js"></script>
<script>

// Full list of configuration options available at:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
    math: {
        mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js',
        config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
    },
    controls: true,
    progress: true,
    history: true,
    center: false,
    transition: 'slide',

    // // optional configurations for reveald3
    reveald3: {

         // If the previous slide is a slide further in the deck (i.e. we come back to
         // slide from the next slide), by default the last fragment transition will be
         // triggered to to get the last state of the visualization and simulate the
         // the state the simulation was in when we left the slide. This can be
         // discarded.
         runLastState: true, //default true

         // Specifies if iframes (that host the visualization) have to be kept
         // on the slide once the slide is not active anymore (e.g.: navigating
         // to next slide). If true, the current visualization will be kept
         // active so that its state will be the one displayed if we navigate
         // back to the slide. This is false by default, as it can be the source
         // of performance issues if complex visualizations (e.g. force layout)
         // are displayed and kept in the background.
         // Also, see the runLastState option as a simpler less
         // resource-demanding alternative.
         keepIframe: false, // default: false


         // This will prefix the path attributes of the source html paths with the given path.
         // (by default "src" if set to true or with the specified path if string)
         mapPath: false, // default: false

         // If true, will try to locate the file at a fallback url without the mapPath prefix in case no file is found
         // at the stipulated url with mapPath
         tryFallbackURL: false, //default false
    },

    // Reveal.js plugins
    dependencies: [
        { src: 'plugin/math/math.js', async: true },
        { src: 'reveald3.js' },

    ]
});

</script>
</body>
</html>
